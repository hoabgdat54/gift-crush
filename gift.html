<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <title>Qu√† cho em üíñ</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{
      --pink:#ffb6c1;
      --sky:#87ceeb;
      --card-bg: rgba(255,255,255,0.85);
    }
    *{box-sizing:border-box}
    html,body{
      height:100%;
      margin:0;
      font-family: "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    .wrap{
      position:relative;
      height:100%;
      width:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
      background: radial-gradient(circle at 10% 10%, rgba(255,182,193,0.08), transparent 10%),
                  radial-gradient(circle at 90% 90%, rgba(135,206,235,0.06), transparent 10%);
    }
    /* background image */
    .bg{
      position:absolute;
      inset:0;
      background-image: url('assets/bg.png');
      background-size: cover;
      background-position: center;
      filter: saturate(0.95) contrast(1.02);
      transform: scale(1.02);
      z-index:0;
    }

    /* overlay gradient */
    .overlay{
      position:absolute; inset:0;
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.18));
      z-index:1;
    }

    /* hearts */
    .heart {
      position:absolute;
      font-size:20px;
      z-index:3;
      pointer-events:none;
      animation: floatUp 6s linear forwards;
      opacity:0;
      transform-origin:center;
      filter: drop-shadow(0 6px 12px rgba(0,0,0,0.15));
    }
    @keyframes floatUp {
      0% { transform: translateY(0) scale(0.9); opacity:1; }
      80% { opacity:1; }
      100% { transform: translateY(-900px) scale(1.4); opacity:0; }
    }

    /* center envelope */
    .center{
      position:relative;
      z-index:4;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:18px;
      text-align:center;
      padding:20px;
    }
    .envelope{
      width:170px;
      height:110px;
      background: linear-gradient(180deg, var(--sky), #4fb0e5);
      border-radius:14px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      transform-origin:center;
      transition: transform 220ms ease, box-shadow 220ms ease;
      position:relative;
    }
    .envelope:hover{ transform: translateY(-6px) scale(1.02); box-shadow: 0 18px 40px rgba(0,0,0,0.28); }
    .envelope:after{
      content:'';
      position:absolute;
      left:8px; right:8px; top:10px;
      height:60px;
      background: linear-gradient(135deg, rgba(255,255,255,0.25), rgba(255,255,255,0.05));
      border-radius:12px;
      transform: rotateX(10deg);
    }
    .envelope .heart-sm{
      font-size:26px;
      transform: translateY(-8px);
    }
    .title{
      color:#fff;
      font-size:22px;
      text-shadow: 0 4px 18px rgba(0,0,0,0.35);
      z-index:5;
    }

    /* letter modal */
    .letter{
      position:fixed;
      left:50%; top:50%;
      transform: translate(-50%,-50%) scale(0.9);
      width: min(720px, 92%);
      max-width:720px;
      background: var(--card-bg);
      border-radius:16px;
      padding:28px;
      box-shadow: 0 30px 80px rgba(0,0,0,0.35);
      z-index:6;
      opacity:0;
      pointer-events:none;
      transition: all 320ms ease;
    }
    .letter.open{ opacity:1; pointer-events:auto; transform: translate(-50%,-50%) scale(1); }
    .letter h2{ margin:0 0 10px; color:#333 }
    .letter p{ color:#222; line-height:1.6; font-size:18px }
    .closeBtn{
      margin-top:18px;
      background: linear-gradient(90deg,var(--pink),var(--sky));
      color:white;
      padding:10px 16px;
      border-radius:10px;
      border:none;
      cursor:pointer;
      font-weight:700;
      box-shadow: 0 6px 18px rgba(135,206,235,0.18);
    }

    /* typing effect */
    .typed { white-space:pre-wrap; font-family: inherit; font-size:18px; color:#222; }

    /* small controls */
    .controls{ margin-top:12px; display:flex; gap:10px; justify-content:center; }
    .btn-simple{ background:transparent; border:1px solid rgba(0,0,0,0.08); padding:8px 12px; border-radius:10px; cursor:pointer; }
  </style>
</head>
<body>
  <div class="wrap" role="main" aria-label="Qu√† t·∫∑ng">
    <div class="bg" aria-hidden="true"></div>
    <div class="overlay" aria-hidden="true"></div>

    <!-- floating hearts will be injected here -->
    <div id="heartsHolder" aria-hidden="true"></div>

    <div class="center">
      <div class="title">M·ªü phong b√¨ ƒë·ªÉ nh·∫≠n qu√† üíå</div>
      <div class="envelope" id="envelope" role="button" aria-label="M·ªü phong b√¨">
        <div class="heart-sm">üíô</div>
      </div>
      <div style="color: #fff; font-size:14px; text-shadow:0 2px 6px rgba(0,0,0,0.25)">Ch·ªß ƒë·ªÅ: H·ªìng & Xanh bi·ªÉn</div>
    </div>

    <!-- Letter modal -->
    <div class="letter" id="letter" role="dialog" aria-modal="true" aria-hidden="true">
      <h2>G·ª≠i em th∆∞∆°ng m·∫øn üíñ</h2>
      <div class="typed" id="typed"></div>

      <div class="controls">
        <button class="closeBtn" id="closeBtn">ƒê√≥ng th∆∞</button>
        <button class="btn-simple" id="playMusic">Nghe nh·∫°c</button>
        <button class="btn-simple" id="downloadBtn">T·∫£i ·∫£nh n·ªÅn</button>
      </div>
    </div>

    <!-- audio (will be controlled via JS) -->
    <audio id="music" preload="auto">
      <source src="https://files.catbox.moe/7j3p4v.mp3" type="audio/mp3">
    </audio>

  </div>

  <script>
    // Hearts generator
    const heartsHolder = document.getElementById('heartsHolder');
    function makeHeart(){
      const d = document.createElement('div');
      d.className = 'heart';
      d.style.left = Math.random()*100 + 'vw';
      d.style.top = (100 + Math.random()*30) + 'vh';
      d.style.opacity = 0.95;
      const size = Math.random()*26 + 14;
      d.style.fontSize = size + 'px';
      d.style.transform = 'translateY(0)';
      d.innerHTML = 'üíó';
      heartsHolder.appendChild(d);
      // stagger animation duration & delay
      const dur = 5 + Math.random()*4;
      d.style.animationDuration = dur + 's';
      d.style.animationDelay = (Math.random()*1)+'s';
      setTimeout(()=> d.remove(), (dur+1)*1000);
    }
    setInterval(makeHeart, 350);

    // Envelope interaction
    const envelope = document.getElementById('envelope');
    const letter = document.getElementById('letter');
    const typedEl = document.getElementById('typed');
    const music = document.getElementById('music');

    const message = "Ch√†o em,

Anh g·ª≠i em m·∫£nh gh√©p nh·ªè n√†y ‚Äî m·ªôt l·ªùi ch√∫c, m·ªôt n·ª• c∆∞·ªùi v√† th·∫≠t nhi·ªÅu th∆∞∆°ng nh·ªõ. Ch√∫c em lu√¥n xinh ƒë·∫πp, vui v·∫ª v√† m·ªói ng√†y ƒë·ªÅu t∆∞∆°i nh∆∞ n·∫Øng bi·ªÉn. Hy v·ªçng m√≥n qu√† nh·ªè n√†y s·∫Ω l√†m em m·ªâm c∆∞·ªùi üíñ\n\n- Ng∆∞·ªùi g·ª≠i";
    let idx = 0;

    function openLetter(){
      envelope.animate([
        { transform: 'translateY(0) scale(1)' },
        { transform: 'translateY(-8px) scale(0.98)' },
        { transform: 'translateY(0) scale(1)' }
      ], { duration: 260 });
      setTimeout(()=> {
        letter.classList.add('open');
        letter.setAttribute('aria-hidden','false');
        startTyping();
      }, 260);
    }

    function closeLetter(){
      letter.classList.remove('open');
      letter.setAttribute('aria-hidden','true');
      // stop music optionally
      // music.pause();
    }

    envelope.addEventListener('click', openLetter);
    document.getElementById('closeBtn').addEventListener('click', closeLetter);

    // Typing effect
    function startTyping(){
      typedEl.textContent = '';
      idx = 0;
      function step(){
        if(idx <= message.length){
          typedEl.textContent = message.slice(0, idx);
          idx++;
          setTimeout(step, 28 + (Math.random()*30));
        }
      }
      step();
    }

    // Play music button
    document.getElementById('playMusic').addEventListener('click', function(){
      // try to play; some browsers block autoplay unless user gesture (click) ‚Äî this is a user click so should work
      music.currentTime = 0;
      music.play().catch(e => {
        alert('Tr√¨nh duy·ªát ch·∫∑n ph√°t nh·∫°c t·ª± ƒë·ªông ‚Äî h√£y nh·∫•n l·∫°i ƒë·ªÉ ph√°t.');
      });
    });

    // Download background image
    document.getElementById('downloadBtn').addEventListener('click', function(){
      const link = document.createElement('a');
      link.href = 'assets/bg.png';
      link.download = 'memories.png';
      document.body.appendChild(link);
      link.click();
      link.remove();
    });

    // Accessibility: allow keyboard Enter to open envelope
    envelope.tabIndex = 0;
    envelope.addEventListener('keydown', function(e){
      if(e.key === 'Enter' || e.key === ' ') openLetter();
    });
  </script>
</body>
</html>
